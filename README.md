# 2022-1-Weather-Big-ConTest (2022-1 날씨 빅콘테스트)

## 기상에 따른 혈관 질환 발생 예측 모델 개발

# 목차
- 분석의의 및 목적
- 전처리
- EDA
- modeling
- 분석 결과 해석
- 활용방안 및 개선점
- 내 역할
- 어려웠던점, 해결방법
- 배운점/ 성과

# 분석의의 및 목적

이전부터 심뇌혈관질환의 발병이 기온, 대기오염과 같은 기상인자들과 연관이 있다는 연구결과들이 발표되어왔다(배현주, 2014, p346). 특히 심근경색증은 기온 및 습도와 관련성이 높은 것으로 보고되어 있으며 최근에는 기압과 평균기온의 일 변동성이 뇌졸중 발생에 유의한 영향을 나타낸다는 결과가 새로 보고되었다(안혜연, 2016, p.840). 또한 2003년부터 2010년까지 서울을 중심으로 기상청의 기상관측자료와 국립환경과학원의 대기오염 측정자료, 공단의 심혈관질환 발생건수 등을 종합 분석한 결과, 대기 중 미세먼지가 1μg/m³증가하면 심혈관질환으로 입원할 확률은 1.26% 증가하는 것으로 나타났다(이승운, 2020, p276).

심뇌혈관질환은 골든타임이 무엇보다도 중요한데, 심근경색의 경우 2시간 이내, 뇌졸중의 경우는 3시간 이내에는 치료받아야 한다. 따라서 일자별 심뇌혈관질환 입원 건수를 미리 예측하여 의료인원 및 치료 시스템을 준비하는 것이 중요하다. 심뇌혈관질환과 연관성이 높은 날씨 및 인구학적, 지리적 파생변수들을 이용해 백병원의 심뇌혈관질환자 입원 건수를 예측하는 것이 분석의 목적이다.


## data

(1) 관측 데이터
기상 변수로는 기온, 기압, 습도, 강수량, 풍속, 적설 등을 사용

(2) 예보 데이터

제공된 예보데이터 중 3시간 기온, 6시간 강수량, 6시간 적설, 12시간 강수량, 12시간 적설, 습도, 일 최고기온, 일 최저기온, 풍속 데이터를 이용하여 24시간 뒤와 48시간 뒤의 예보데이터를 생성

생성한 변수는 24시간 뒤 강수량, 24시간 뒤 신적설, 24시간 뒤 기온, 48시간 뒤 기온, 24시간 뒤 습도, 48시간 뒤 습도, 24시간 뒤 최고기온, 24시간 뒤 풍속, 48시간 뒤 풍속이며 해당 변수들은 다음과 같은 방식으로 생성했다.

  ※ 24시간 뒤 예보 : 해당 일 23시 기준 +4, +10, +16, +22 예보 값의 평균 또는 합 

  ※ 48시간 뒤 예보 : 해당 일 23시 기준 +28, +38, +40, +46 예보 값의 평균 또는 합


(3) 지수 데이터

기상청 날씨마루 HIVE에서 제공된 기상생활지수 데이터 중 체감온도(A03)와 자외선지수(A07),뇌졸중위험지수(D07)을 이용하여 당일, 24시간 뒤, 48시간 뒤 지수값의 평균값, 최소값, 최대값, 범위를 계산

(4) 대기오염 데이터

시간별로 하루에 24번 기록된데이터 값을 평균하여 일별 데이터로 사용하였다. 

사용 변수는 미세먼지 (PM10), 오존(O3), 이산화질소(NO2), 일산화탄소(CO), 아황산가스(SO2) 수치이다.

# 전처리

- 관측 데이터, 지수 데이터, 대기오염 데이터는 MICE를 이용하여 결측치 처리를 했고, 상대적으로 변수가 적은 예보 데이터는 interpolate를 이용해 단일 변수로 결측치 처리를 진행했다.

- 세종은 2012년 7월에 출범한 신도시이기 때문에 많은 기상 데이터가 결 측이었다. 특히 세종의 ASOS는 2020년에서야 설치되었기 때문에 2012년부터 2016년까지 모든 기간의 관측 데이터가 모두 결 측이었다. 따라서 관측 데이터와 대기오염 데이터의 모든 관측 지점의 위치를 지도로 시각화한 뒤 세종 근방의 관측 지점들의 평균값으로 세종 지역의 결측치를 대체하였다.

- 시도별 혹은 읍면동(ex. 강릉 혹 갈말읍)으로 이루어져 있는 데이터들을 하나의 지역(ex. 강원)으로 합치는 과정에서 지역별 인구학적 특징을 날씨에 반영하기 위해 인구 가중치를 적용했다.

## 파생 변수

(1) 기상 지연변수(lag1 ~ lag21)

(2) 범주형 변수 인코딩

(3) 주요 기상변수(온도, 압력, 강수량, 풍속)의 7일 평균 및 14일 평균 

(4) 일교차 변수 및 큰 일교차 횟수

(5) 심정지, 고혈압, 뇌졸중 약물치료 및 진단, 가족력

    지역별·성별·연도별 심정지, 고혈압, 뇌졸중 약물치료 환자 수 합, 진단 환자 수 합, 가족력 여부 변수를 추가
    
(6) 월별 지역별 50대 이상 인구수

(7) 지역별 백병원 개수

(8) 일자 관련 변수

    1일여부, 월요일여부, 주말, 요일, year, 공휴일여부
    
(9) 건강 관련 변수
    지역별 연도별 음주율, 흡연율, 비만율, 신체활동량, 건강인지율


# EDA

# modeling

(1) Bayesian Ridge

(2) Lasso Regression

(3) Random Forest

(4) Bayesian Ridge 2주 학습

## 모형 앙상블

- Bayesian Ridge, Random Forest 모델을 5:5로 앙상블 하여 br_rf 모델을 생성한 후, br_rf, Lasso Regression, Bayesian Ridge_2_week 모델을 2:2:1로 앙상블  

- 지역별, 성별, 일자별 평균값을 가중치로 부여하여 최종 모델을 생성
  EDA 결과에서 알 수 있듯 frequency 값은 지역별, 성별, 일자별에 따라 서로 다른 분포를 보인다. 이 차이를 모델에 반영

# 분석 결과 해석

## 모형에 대한 해석

  단순한 회귀 모형이 더 적절한 결과
  
## 중요 요인에 대한 해석

- 지역: 지역 및 인구학적 특징에 따라 frequency 값은 큰 편차를 보인다. 경기, 서울은 입원건수가 상대적으로 높았고 제주, 세종은 상대적으로 낮게 분포되어 있다.

- 일자: 일자별 frequency 값은 편차를 보이는데 특히 1일인 경우 다른 날들에 비해 frequency 값이 상대적으로 높았다. 이는 행정상 보험료 산출을 위해 익월 1일로 입원 일자가 처리되었기 때문이라고 추정할 수 있다.

# 활용방안 및 개선점

- 기상 및 지리적, 인구학적 데이터를 기반으로 백병원의 심뇌혈관질환자 입원건수를 예측하는 모델을 병원 전산 시스템에 도입하여 일자별 환자 수 변화에 대응할 수 있다. 이는 높은 입원건수가 나타나는 계절, 기상요건 등에 따라 필요 인력 및 의료자원을 사전에 구축해 시의적절한 대응을 기대할 수 있다.

- 지역별 입원건수의 차이를 보이므로 모델 기반으로 지역 맞춤형 보건사업 및 정책을 수립하여 심뇌혈관질환 취약 지역에 지원을 강화해 지역사회 건강수준의 전반적인 향상을 기대할 수 있다


# 내역할

# 어려웠던점, 해결방법


# 배운점/ 성과






